!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("stimulus")):"function"==typeof define&&define.amd?define(["stimulus"],t):(e="undefined"!=typeof globalThis?globalThis:e||self)["stimulus-content-loader"]=t(e.Stimulus)}(this,(function(e){"use strict";class t extends e.Controller{connect(){this.hasUrlValue?this.hasLazyLoadingValue?this.lazyLoad():this.load():console.error("[stimulus-content-loader] You need to pass an url to fetch the remote content.")}disconnect(){this.stopRefreshing()}load(){this.fetch(),this.hasRefreshIntervalValue&&this.startRefreshing()}lazyLoad(){const e={threshold:this.lazyLoadingThresholdValue,rootMargin:this.lazyLoadingRootMarginValue||"0px"};new IntersectionObserver(((e,t)=>{e.forEach((e=>{e.isIntersecting&&(this.load(),t.unobserve(e.target))}))}),e).observe(this.element)}fetch(){fetch(this.urlValue).then((e=>e.text())).then((e=>{this.element.innerHTML=e,this.loadScriptsValue&&this.loadScripts()}))}startRefreshing(){this.refreshTimer=setInterval((()=>{this.fetch()}),this.refreshIntervalValue)}stopRefreshing(){this.refreshTimer&&clearInterval(this.refreshTimer)}loadScripts(){this.element.querySelectorAll("script").forEach((e=>{const t=document.createElement("script");t.innerHTML=e.innerHTML,document.head.appendChild(t).parentNode.removeChild(t)}))}}return t.values={url:String,lazyLoading:Boolean,lazyLoadingThreshold:Number,lazyLoadingRootMargin:String,refreshInterval:Number,loadScripts:Boolean},t}));
